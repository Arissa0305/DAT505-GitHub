Space Travel
=========
Shi Shi B161006081
### Catalog ###
Space Travel
* audio(Music document)
 * The truth that you leave.mp3
* build
 * OrbitControls.js
 * three.min.js
* css
 * music1.svg
 * music2.svg
 * style.css
* js
 * libs
   * inflate.min.js
   * stats.min.js
 * loaders
   * FBXLoader.js
 * index.js
 * jquery-3.3.1.min.js
 * three.js
 * WebGL.js
* models
 * rabbit3.FBX
* texture
 * star1.svg
* index.js
* README.md

#### links ####
[DAT505-GitHub](https://github.com/Arissa0305/DAT505-GitHub/tree/master/Shi%20Shi-DAT505-Assignment).

### Effect diagram ###
![1](https://raw.githubusercontent.com/Arissa0305/DAT505-GitHub/master/Image/fw1.png)

![2](https://raw.githubusercontent.com/Arissa0305/DAT505-GitHub/master/Image/fw2.png)

![3](https://raw.githubusercontent.com/Arissa0305/DAT505-GitHub/master/Image/fw3.png)

![4](https://raw.githubusercontent.com/Arissa0305/DAT505-GitHub/master/Image/fw4.png)

### Creativity and ideas ###
"All men have the stars, but they are not the same things for different people..." Every time I see the stars, I always have an infinite reverie. This assignment is intended to express my vision of the stars and fairy tales, so my assignment is to use three.js technology to present a dynamic 3D interactive work about the star sky.<br>
After the first three weeks of learning, I tried to build a assignment, with what I learned, and I thought that the code on geometry in three.js was better suited for building a low polygon style scene, and I was thinking about creating an interactive design with a low polygon style. There are also many problems in the process of homework, such as interaction, I have tried a lot of methods.
### Description ###
The rabbits and rockets in the main part of the scene are created by 3dsmax and then saved to FBX format to load into the scene. The rest is combined with the geometry generated by the code, and the whole scene can be rotated with the mouse. The size and position of the geometric stars and the clouds next to the moon are randomly generated and are different from each refresh.<br> I wanted to add interactive effects to the stars in the sky, and after trying a lot of ways, finally I  succeeded in using `THREE.Raycaster`to bind click events to the model, and when I clicked on the starry sky, it popped up a UI interface, and I clicked on RETURN can be returned. To make the starry effect more obvious, I used a particle system, and then adjusted the `THREE.PointsMaterial` to construct geometry and materials.

### Usage ###
```html
<div class="world"></div>
```
This code creates the foundation of the world through CSS.
```html
</div><a class="btn-music"></a>
<p id="d">
    ↓Click on the little star below to have a surprise↓</p></div>
<div class="ui-dialog ui-dialog-operate">
  <div class="ui-dialog-cnt" style="border: 1px solid #ffffff;">
    <div class="ui-dialog-hd">
      <div class="ui-img"><span id="title">
         Message</span></div>
    </div>
    <div class="ui-dialog-bd">
      <p id="introduce">
        All men have the stars, but they are not the same things for different people.<br>
        For some, who are travelers, the stars are guides. For others they are no more than little lights in the sky.
        For others, who are scholars, they are problems. For my businessman they were wealth.<br>
        But all these stars are silent. You – you alone – will have the stars as no one else has them…
        <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;————《The Little Prince》</p>
    </div>
    <div class="ui-dialog-ft"><button type="button" data-role="button" class="ui-btn">RETURN</button></div>
  </div>
</div>
```
Create the content of the interactive interface, including borders, buttons, text and so on.
```html
<script src="js/three.js"></script>

<script src="build/three.min.js"></script>

<script src="build/OrbitControls.js"></script>

<script src="js/libs/inflate.min.js"></script>

<script src="js/loaders/FBXLoader.js"></script>

<script src="js/WebGL.js"></script>

<script src="js/libs/stats.min.js"></script>

<script src="js/index.js"></script>
```
The purpose of this code is to link the library of three.js.

```javascript
var scene, camera, renderer, controls, mouseDown,  world, width, height;
var ground, dotSystem;
var stats;
var clock = new THREE.Clock();
var mixer;

var meshStar = [];
var material;
var mouse = new THREE.Vector2(), INTERSECTED;
var raycaster;

 function init() {
    width = window.innerWidth,
    height = window.innerHeight;
    scene = new THREE.Scene();
    scene.fog = new THREE.Fog(0x6a96ca, 100, 1000);
    camera = new THREE.PerspectiveCamera(60, width / height, 0.3, 1000);
    camera.lookAt(scene.position);
    camera.position.z = 550;
    renderer = new THREE.WebGLRenderer({
      alpha: true,
      antialias: true
    });
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(width, height);
    renderer.shadowMap.enabled = true;
    renderer.shadowMap.type = THREE.PCFSoftShadowMap;

    controls = new THREE.OrbitControls(camera, renderer.domElement);

   drawGround();
   addLights();
   drawStarSystem();
   drawTree();
   drawflower();
   drawRabbit();
   drawMoon();
   drawCloud();

   world = document.querySelector('.world');
   world.appendChild(renderer.domElement);

  document.addEventListener('mousedown', onMouseDown);
  document.addEventListener('mouseup', onMouseUp);
  document.addEventListener('touchstart', onTouchStart);
  document.addEventListener('touchend', onTouchEnd);
  window.addEventListener('resize', onResize);

   stats = new Stats();
   world.appendChild( stats.dom );
  }
```
The code creates a scene, a camera, a light, a time basic of FBX , defines window size, camera position and the properties of mouse. It also creates container as element`world`, a `WebGL` renderer for the scene and camera, and it adds that viewport to the document.body container.
```javascript
function drawGround() {
  const geometry = new THREE.TetrahedronGeometry(160, 2);
  const material = new THREE.MeshPhongMaterial({
    color: 0xb293a0,
    shading: THREE.FlatShading,
  });
  const geometry1 = new THREE.TetrahedronGeometry(150, 2);
  const material1 = new THREE.MeshPhongMaterial({
    color: 0xb293a0,
    shading: THREE.FlatShading,
  });
  const geometry2 = new THREE.TetrahedronGeometry(160, 2);
  const material2 = new THREE.MeshPhongMaterial({
    color: 0xb293a0,
    shading: THREE.FlatShading,
  });
    ground = new THREE.Mesh(geometry, material);
    ground1 = new THREE.Mesh(geometry1, material1);
    ground2 = new THREE.Mesh(geometry2, material2);

    ground.scale.set(3, 1, 2);
    ground.position.y = -305;
    ground.castShadow = true;
    ground.receiveShadow = true;

    ground1.scale.set(2, 1.3, 1.5);
    ground1.position.set(-450,-280,-200);
    ground1.castShadow = true;
    ground1.receiveShadow = true;


    ground2.scale.set(3, 2, 2);
		ground2.position.set(400,-280,-300);
    ground2.castShadow = true;
    ground2.receiveShadow = true;

    scene.add(ground);
    scene.add(ground1);
    scene.add(ground2);

var FIXEDSCALE = 600;
var pts = [], numPts = 5;

for (var i = 0; i < numPts * 2; i++) {

	var l = i % 2 == 1 ? 10 : 20;

	var a = i / numPts * Math.PI;

	pts.push(new THREE.Vector2(Math.cos(a) * l, Math.sin(a) * l));

}

var shape = new THREE.Shape(pts);

var extrudeSettings = {
	depth: 5,
	steps: 1,
	bevelEnabled: true,
	bevelThickness: 2,
	bevelSize: 4,
	bevelSegments: 1
};
var geometryStar = new THREE.ExtrudeBufferGeometry(shape, extrudeSettings);
for (let i = 0; i < 20; i++) {
	meshStar[i] = new THREE.Mesh(geometryStar, material);
	meshStar[i].position.set(50, 100, 50);
	meshStar[i].position.set(Math.random() * (Math.random > .5 ? 1 : -1) * FIXEDSCALE, Math.random() * FIXEDSCALE, Math.random() * (Math.random > .5 ? 1 : -1) * FIXEDSCALE);
	scene.add(meshStar[i]);
}

  raycaster = new THREE.Raycaster();

  }
  ```
This code uses geometric code to combine the ground and stars, and uses the same material. In addition, I set a fixedscale, and then randomly generate a number multiplied by this value, you can achieve the random size of stars. Then add the click event with `THREE.Raycaster`.<br>
Trees, flowers, clouds and moons are also made up of geometric codes. Rabbits and rockets use `THREE.FBXLoader`, please see the file for details.
```javascript
function drawStarSystem() {
    starSystem = new THREE.Group();
    scene.add(starSystem);

    const system1 = new StarSystem({
      intensity: 3000,
      color: 0xE1FEA4,
      xSpread: 800,
      ySpread: 800,
      zSpread: 800,
    });
    starSystem.add(system1.group);

    const system2 = new StarSystem({
      intensity: 100,
      color: 0xFF007B,
      xSpread: 300,
      ySpread: 500,
      zSpread: 400,
      size: 13,
    });
    system2.group.position.set(-100, -80, 0);
    starSystem.add(system2.group);
  }
class StarSystem {
    constructor({
      intensity = 5000,
      color = 0xffffff,
      xSpread = 1000,
      ySpread = 1000,
      zSpread = 1000,
      size = 6,
    }) {
      this.group = new THREE.Group();

      this.intensity = intensity;
      this.color = color;
      this.xSpread = xSpread;
      this.ySpread = ySpread;
      this.zSpread = zSpread;
      this.size = size;

      this.draw();
    }
    draw() {
      const geometry = new THREE.Geometry();
      const colors = [];

      const loader = new THREE.TextureLoader();
      loader.crossOrigin = false;
      loader.load("texture/star1.svg", (texture) => {
        for (var i = 0; i < this.intensity; i += 1) {
          const star = new THREE.Vector3();
          star.x = THREE.Math.randFloatSpread(this.xSpread);
          star.y = THREE.Math.randFloatSpread(this.ySpread);
          star.z = THREE.Math.randFloatSpread(this.zSpread);

          geometry.vertices.push(star);

          colors[i] = new THREE.Color(this.color);
        }
        geometry.colors = colors;

        const material = new THREE.PointsMaterial({
          size: this.size,
          map: texture,
          vertexColors: THREE.VertexColors,
          alphaTest: 0.5,
          transparent: true,
        });

        const particles = new THREE.Points(geometry, material);
        this.group.add(particles);
      });
    }
  }
  ```
  This code creates the starry effect through the` THREE.PointsMaterial`, I created two groups, one group behind the scene to achieve the starry effect, the other group scattered throughout the scene.
  ```javascript
  const worldMusic = document.querySelector('.music');
  const btnMusic = document.querySelector('.btn-music');

  let playMusic = false;

  btnMusic.addEventListener('click', () => {
    playMusic = !playMusic;
    btnMusic.classList.toggle('music-off');
    playMusic ? worldMusic.play() : worldMusic.pause();
  });

  worldMusic.volume = 0.3;
  worldMusic.loop = true;
```
This code links the music with the buttons set in CSS to control the playing of the music, close the loop and volume.
